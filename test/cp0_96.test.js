const gv = require('../src/handler/globalVarible');
gv.wrap(require('../utils/initGv'))();
const { main, swap4, swap2, hexnum, stringReverse, init } = gv.utils;

const valueMap = {
  "62": hexnum(gv.cp0_96(6, 29)),
  "driver-evaluate": stringReverse(gv.cp0_96(6, 81)),
  "_playwrightRecorderState,_playwrightRecorderSetSelector,_playwrightResume,_playwrightRecorderPerformAction,_playwrightRecorderRecordAction": swap2(gv.cp0_96(6, 57)),
  "PDF.PdfCtrl": stringReverse(gv.cp0_96(9, 17)),
  measureText: main(gv.cp0_96(9, 30)).join(),
  Sogou: swap2(gv.cp0_96(9, 80)),
  katalonSendMessage: hexnum(gv.cp0_96(10, 39)),
  productSub: stringReverse(gv.cp0_96(10, 41)),
  'location,href,innerHTML,action,src,search,onclick,value,pathname,host,hostname,port,hash,protocol,attributes,outerHTML,onsubmit,nodeValue,referrer,URL,documentURI': swap2(gv.cp0_96(11, 29)),
  drawImage: main(gv.cp0_96(11, 31)).join(),
  fillRect: swap2(gv.cp0_96(11, 86)),
  navigator: swap2(gv.cp0_96(11, 93)),
  "{\\s*\\[native code\\]\\s*}": swap2(gv.cp0_96(12, 10)),
  MSBlobBuilder: hexnum(gv.cp0_96(12, 24)), // window.MSBlobBuilder, IE10以下支持
  "UCWebExt,ucweb": stringReverse(gv.cp0_96(12, 39)),
  vendor: swap2(gv.cp0_96(12, 61)),
  standalone: hexnum(gv.cp0_96(13, 1)), // navigator.standalone判断是否是ios的主屏幕启动
  getImageData: stringReverse(gv.cp0_96(6, 54)) + gv.cp0_96(10, 9) + gv.cp0_96(8, 37),
  WebXMLogMsg_UNIQUE_: gv.cp0_96(6, 58) + gv.cp0_96(7, 59) + main(gv.cp0_96(9, 22)).join(),
  language: gv.cp0_96(3, 19) + gv.cp0_96(4, 33) + gv.cp0_96(4, 1) + gv.cp0_96(4, 22),
  msMaxTouchPoints: gv.cp0_96(6, 5) + gv.cp0_96(9, 90) + gv.cp0_96(13, 14) + gv.cp0_96(10, 82),
  toFixed: hexnum(gv.cp0_96(7, 32)) + gv.cp0_96(11, 16) + gv.cp0_96(6, 88),
  "//html": gv.cp0_96(1, 2) + gv.cp0_96(10, 87) + gv.cp0_96(4, 12) + gv.cp0_96(5, 87),
  Image: stringReverse(gv.cp0_96(7, 37)),
  "Android 4\\.[0-3].+ (GT|SM|SCH)-": stringReverse(gv.cp0_96(13, 58)),
  oldConfirm: main(gv.cp0_96(5, 6)).join(),
  "53": swap4(gv.cp0_96(11, 41)),
  "FaveIconJavaInterface,jesion": swap4(gv.cp0_96(5, 65)),
  '<object id="bb82kj" classid="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px" height="0px"></object>': swap4(gv.cp0_96(9, 33)),
  "11.678": swap2(gv.cp0_96(8, 48)),
  "(url, frameName, features) => {": swap4(gv.cp0_96(6, 25)) + gv.cp0_96(11, 33) + gv.cp0_96(4, 94),
  "Gamepad": stringReverse(gv.cp0_96(6, 3)) + stringReverse(gv.cp0_96(13, 36)),
  "rgba(": swap4(gv.cp0_96(11, 27)),
  parseFloat: main(gv.cp0_96(5, 82)).join(),
  xwalk: hexnum(gv.cp0_96(12, 91)) + gv.cp0_96(0, 46) + gv.cp0_96(13, 64),
  cross: main(gv.cp0_96(6, 84)).join(),
  "rv:11.": swap2(gv.cp0_96(8, 55)),
  _doc: stringReverse(gv.cp0_96(4, 74)),
  appVersion: stringReverse(gv.cp0_96(11, 47)),
  ret_nodes: swap2(gv.cp0_96(11, 21)) + swap4(gv.cp0_96(5, 91)),
  QTP_EPE_HOOK: gv.cp0_96(9, 13) + gv.cp0_96(9, 49) + gv.cp0_96(4, 48) + gv.cp0_96(11, 10),
  msDoNotTrack: hexnum(gv.cp0_96(10, 32)),
  green: main(gv.cp0_96(10, 78)).join(),
  "50": swap4(gv.cp0_96(11, 95)),
  PointerEvent: swap2(gv.cp0_96(8, 33)) + swap4(gv.cp0_96(4, 73)),
  QQBrowser: swap4(gv.cp0_96(7, 23)),
  'SQLException,SVGException,XPathException,MediaController,HTMLAppletElement,HTMLKeygenElement,OverflowEvent,SVGPaint': swap2(gv.cp0_96(6, 14)) + gv.cp0_96(10, 31) + gv.cp0_96(7, 19),
  platform: stringReverse(gv.cp0_96(5, 43)),
  "49": hexnum(gv.cp0_96(10, 94)),
  "67": stringReverse(gv.cp0_96(8, 70)),
  getContext: stringReverse(gv.cp0_96(11, 30)) + stringReverse(gv.cp0_96(11, 72)),
  'AudioTrackList,defaultStatus,Object.setPrototypeOf,taobrowser_Event,webkitRequestFileSystem,onoperadetachedviewchange,Path2D.prototype.addPath,SourceBuffer.prototype.changeType,weatherBridge,chrome.csi,password_manager_enabled,document.body.x-ms-acceleratorkey,external.AddFavorite,SogouLoginUtils,SourceBuffer,showModalDialog,document.selection.typeDetail,SVGPatternElement.SVG_UNIT_TYPE_OBJECTBOUNDINGBOX,document.onselectionchange,document.body.style.backgroundBlendMode,document.documentElement.onresize,CanvasRenderingContext2D.prototype.webkitGetImageDataHD,UCWebExt,CDATASection.prototype.remove,BlobDownloadCallback,_WXJS,document.msCapsLockWarningOff,CSSCharsetRule,document.scrollingElement.style.fontVariantNumeric,Function.prototype.bind,chrome.app.InstallState,isNodeWhitespace,Object.seal,document.defaultCharset,__firefox__,onmessage,__sogou_secure_input,CloseEvent.prototype.initCloseEvent,getMatchedCSSRules,Notification,HTMLFrameSetElement.prototype.hasPointerCapture,document.body.onmouseenter,OffscreenCanvasRenderingContext2D,chrome,Object.prototype.__defineSetter__,document.fileCreatedDate,webkitAudioContext.prototype.close,GetPerfTests,MediaController,external.IsSearchProviderInstalled,TextTrackList.prototype.getTrackById,document.selection,document.body.style.lineBreak,document.body.style.textAlignLast,ScreenOrientation,document.body.style.minWidth,SpeechSynthesisUtterance,onerror,WebKitFlags,ReaderModeArticlePage,__opera,PerformancePaintTiming,performance,document.body.style.msTextSizeAdjust,document.body.onpage,SVGGraphicsElement.prototype.mozRequestPointerLock,ClickData,MediaEncryptedEvent,__$_qihoo360_$__,document.onmousemove,BeforeInstallPromptEvent.prototype.KEYUP,HTMLFrameSetElement.prototype.webkitRequestFullScreen,external': swap2(gv.cp0_96(9, 28)),
  cpuClass: swap4(gv.cp0_96(4, 35)),
  'new oldWebSocket(url': gv.cp0_96(9, 56) + gv.cp0_96(7, 85) + hexnum(gv.cp0_96(10, 84)),
  menubar: swap4(gv.cp0_96(10, 63)),
  renderProcessId: gv.cp0_96(2, 74) + gv.cp0_96(13, 53) + gv.cp0_96(9, 11) + gv.cp0_96(9, 34),
  oldPrompt: gv.cp0_96(12, 57) + gv.cp0_96(9, 63) + gv.cp0_96(7, 78) + gv.cp0_96(4, 76),
  mozvisibilitychange: stringReverse(gv.cp0_96(8, 91)),
  arity: swap4(gv.cp0_96(11, 71)),
  isBrave: swap2(gv.cp0_96(9, 43)),
  "120": swap4(gv.cp0_96(9, 71)),
  'Firefox/(\\d+)': stringReverse(gv.cp0_96(9, 60)),
  red: swap4(gv.cp0_96(10, 38)),
  clientInformation: swap4(gv.cp0_96(10, 75)),
  createExpression: gv.cp0_96(10, 71) + gv.cp0_96(7, 15) + swap4(gv.cp0_96(7, 33)),
  webstore: hexnum(gv.cp0_96(4, 50)),
  webkitPersistentStorage: swap4(gv.cp0_96(5, 21)),
  HeadlessChrome: gv.cp0_96(12, 18) + gv.cp0_96(13, 2) + gv.cp0_96(11, 74) + gv.cp0_96(6, 59),
  'LiebaoAdMatchUrl,LiebaoAutoFill_gameAccountInfo,LiebaoBackup_Backup,LiebaoBackup_GetVersion,LiebaoBackup_Load,LiebaoBackup_Recovery,LiebaoBackup_State,LiebaoCallRequest,LiebaoCallRequestAsync,LiebaoDownloadUrl,LiebaoGetPrefs,LiebaoGetUserInfo,LiebaoGetUUID,LiebaoGetVersion,LiebaoInst,LieBaoLookupDnsAddress,LiebaoOpenImageOcr,LiebaoRememberSelection,LieBaoSendRequest,LieBaoSetHostAddress,LiebaoUninsKPDF,NotifyLiebao,NotifyLiebaoEx': stringReverse(gv.cp0_96(9, 61)),
  textBaseline: main(gv.cp0_96(10, 83)).join() + hexnum(gv.cp0_96(4, 88)),
  __Zm9ybS5pZAo__: swap4(gv.cp0_96(5, 41)),
  CefSharp: stringReverse(gv.cp0_96(10, 70)),
  'Skype.Detection': swap4(gv.cp0_96(10, 53)) + hexnum(gv.cp0_96(6, 23)),
}

test('cp0_96数据对比', () => {
  Object.entries(valueMap).forEach(([tb, ex]) => {
    expect(tb).toBe(ex);
  })
});
